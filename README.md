# Проект "Digital messages"

### Цель
Предоставить пользователю сервис, на котором можно быстро отправить собеседнику сообщение

### Технологический стек:
- python 3.6
- django 3.0+
- sqlite 3.22+

### Инструкция по настройке проекта:
1. Склонировать проект
2. Открыть проект в PyCharm с наcтройками по умолчанию
3. Создать виртуальное окружение (через settings -> project "simple votings" -> project interpreter)
4. Открыть терминал в PyCharm, проверить, что виртуальное окружение активировано.
5. Обновить pip:
```bash
pip install --upgrade pip
```
6. Установить в виртуальное окружение необходимые пакеты: 
```bash
pip install -r requirements.txt
```
7. Синхронизировать структуру базы данных с моделями: 
```bash
python manage.py migrate
```
8. Создать конфигурацию запуска в PyCharm (файл `manage.py`, опция `runserver`)


### Дополнительно в данной ветке
Как я уже говорил джанго из коробки не поддерживает работу с вебсокетами (во всяком случае таких решений я не нашёл), поэтому для работы с вебсокетами использовался пакет "channels" (https://channels.readthedocs.io/en/latest/index.html#). Собственно на сайте есть туториал, который я использовал, чтобы прикрутить вебсокеты, т.ч. не буду пояснять какие файлы я добавил/изменил в проекте, кому интересно - пока что попробуйте его почитать. Основные архитектурные моменты:

- channels пока что использует redis в качестве "backing store", т.е. хранилища, которое хранит сообщения от сокетов в рамках сессии.  Я говорю "пока что", потому что в дальнейшем надо будет переходить на использование БД и я пока не знаю как они скрещиваются с redis

- для установки и запуска redis используется docker. Возможно можно обойтись и без него но на эту тему я исследования не проводил)

Чтобы у вас всё работало, нужно:
- посмотреть в requirements.txt, добавил туда два новых пакета: channels==2.4 и channels_redis. Установите их.

В обычном терминале линукса:
- установить docker - выполнить команду : `apt install docker.io`
- создать группу докер (у меня вроде автоматом создалась): `sudo groupadd docker`
- добавить своего пользователя в эту группу: `sudo usermod -aG docker $USER`, где вместо "$USER" ваш пользователь, например "prom"
- перезагрузить машину
- опять открыть терминал, для проверки работоспособности докера выполнить `docker run hello-world`, если ошибок нет,  т.е. произошла загрузка и вывод тестового сообщения в консоль, значит всё ок.
- для запуска redis выполнить команду: `docker run -p 6379:6379 -d redis:2.8`

Всё, после всех выполненных действий, можно запускать проект и пробовать открыть окно чата в нескольких браузерах и попробовать попереписоваться.